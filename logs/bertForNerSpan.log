2021-06-08 18:36:22,568 - INFO - bertNerSpanExample.py - <module> - 212 - {1: 'PRO', 2: 'ORG', 3: 'CONT', 4: 'RACE', 5: 'NAME', 6: 'EDU', 7: 'LOC', 8: 'TITLE'}
2021-06-08 18:36:22,568 - INFO - bertNerSpanExample.py - <module> - 214 - Namespace(adam_epsilon=1e-08, bert_dir='../../model_hub/bert-base-case/', data_dir='../data/cner/', dropout_prob=0.1, eval_batch_size=12, eval_model=True, gpu_ids='0', log_dir='../logs/', lr=2e-05, max_grad_norm=1.0, max_seq_len=150, num_tags=9, other_lr=0.002, output_dir='../checkpoints/', seed=123, swa_start=3, train_batch_size=32, train_epochs=3, warmup_proportion=0.1, weight_decay=0.01)
2021-06-08 18:36:43,499 - INFO - bertNerSpanExample.py - <module> - 212 - {1: 'PRO', 2: 'ORG', 3: 'CONT', 4: 'RACE', 5: 'NAME', 6: 'EDU', 7: 'LOC', 8: 'TITLE'}
2021-06-08 18:36:43,500 - INFO - bertNerSpanExample.py - <module> - 214 - Namespace(adam_epsilon=1e-08, bert_dir='../../model_hub/bert-base-case/', data_dir='../data/cner/', dropout_prob=0.1, eval_batch_size=12, eval_model=True, gpu_ids='0', log_dir='../logs/', lr=2e-05, max_grad_norm=1.0, max_seq_len=150, num_tags=9, other_lr=0.002, output_dir='../checkpoints/', seed=123, swa_start=3, train_batch_size=32, train_epochs=3, warmup_proportion=0.1, weight_decay=0.01)
2021-06-08 18:36:49,400 - INFO - trainUtils.py - load_model_and_parallel - 97 - Use single gpu in: ['0']
2021-06-08 18:36:49,401 - INFO - bertNerSpanExample.py - train - 44 - ***** Running training *****
2021-06-08 18:36:49,402 - INFO - bertNerSpanExample.py - train - 45 -   Num Examples = 3821
2021-06-08 18:36:49,402 - INFO - bertNerSpanExample.py - train - 46 -   Num Epochs = 3
2021-06-08 18:36:49,402 - INFO - bertNerSpanExample.py - train - 47 -   Total training batch size = 32
2021-06-08 18:36:49,402 - INFO - bertNerSpanExample.py - train - 48 -   Total optimization steps = 360
2021-06-08 18:36:55,499 - INFO - bertNerSpanExample.py - train - 72 - Step: 20 / 360 ----> total loss: 2.39701
2021-06-08 18:37:18,488 - INFO - bertNerSpanExample.py - <module> - 212 - {1: 'PRO', 2: 'ORG', 3: 'CONT', 4: 'RACE', 5: 'NAME', 6: 'EDU', 7: 'LOC', 8: 'TITLE'}
2021-06-08 18:37:18,488 - INFO - bertNerSpanExample.py - <module> - 214 - Namespace(adam_epsilon=1e-08, bert_dir='../../model_hub/bert-base-case/', data_dir='../data/cner/', dropout_prob=0.1, eval_batch_size=12, eval_model=True, gpu_ids='0', log_dir='../logs/', lr=2e-05, max_grad_norm=1.0, max_seq_len=150, num_tags=9, other_lr=0.002, output_dir='../checkpoints/', seed=123, swa_start=3, train_batch_size=32, train_epochs=3, warmup_proportion=0.1, weight_decay=0.01)
2021-06-08 18:37:24,435 - INFO - trainUtils.py - load_model_and_parallel - 97 - Use single gpu in: ['0']
2021-06-08 18:37:24,437 - INFO - bertNerSpanExample.py - train - 44 - ***** Running training *****
2021-06-08 18:37:24,437 - INFO - bertNerSpanExample.py - train - 45 -   Num Examples = 3821
2021-06-08 18:37:24,437 - INFO - bertNerSpanExample.py - train - 46 -   Num Epochs = 3
2021-06-08 18:37:24,437 - INFO - bertNerSpanExample.py - train - 47 -   Total training batch size = 32
2021-06-08 18:37:24,437 - INFO - bertNerSpanExample.py - train - 48 -   Total optimization steps = 360
2021-06-08 18:37:30,682 - INFO - bertNerSpanExample.py - train - 72 - Step: 20 / 360 ----> total loss: 2.39701
2021-06-08 18:37:38,545 - INFO - bertNerSpanExample.py - train - 72 - Step: 40 / 360 ----> total loss: 0.87045
2021-06-08 18:37:46,359 - INFO - bertNerSpanExample.py - train - 72 - Step: 60 / 360 ----> total loss: 0.59396
2021-06-08 18:44:49,665 - INFO - bertNerSpanExample.py - <module> - 212 - {1: 'PRO', 2: 'ORG', 3: 'CONT', 4: 'RACE', 5: 'NAME', 6: 'EDU', 7: 'LOC', 8: 'TITLE'}
2021-06-08 18:44:49,665 - INFO - bertNerSpanExample.py - <module> - 214 - Namespace(adam_epsilon=1e-08, bert_dir='../../model_hub/bert-base-case/', data_dir='../data/cner/', dropout_prob=0.1, eval_batch_size=12, eval_model=True, gpu_ids='0', log_dir='../logs/', lr=2e-05, max_grad_norm=1.0, max_seq_len=150, num_tags=9, other_lr=0.002, output_dir='../checkpoints/', seed=123, swa_start=3, train_batch_size=32, train_epochs=3, warmup_proportion=0.1, weight_decay=0.01)
2021-06-08 18:44:55,688 - INFO - trainUtils.py - load_model_and_parallel - 97 - Use single gpu in: ['0']
2021-06-08 18:44:55,690 - INFO - bertNerSpanExample.py - train - 44 - ***** Running training *****
2021-06-08 18:44:55,690 - INFO - bertNerSpanExample.py - train - 45 -   Num Examples = 3821
2021-06-08 18:44:55,690 - INFO - bertNerSpanExample.py - train - 46 -   Num Epochs = 3
2021-06-08 18:44:55,690 - INFO - bertNerSpanExample.py - train - 47 -   Total training batch size = 32
2021-06-08 18:44:55,690 - INFO - bertNerSpanExample.py - train - 48 -   Total optimization steps = 360
2021-06-08 18:45:03,254 - INFO - bertNerSpanExample.py - train - 72 - Step: 20 / 360 ----> total loss: 2.39701
2021-06-08 18:45:13,204 - INFO - bertNerSpanExample.py - train - 72 - Step: 40 / 360 ----> total loss: 0.87045
2021-06-08 18:45:22,733 - INFO - bertNerSpanExample.py - train - 72 - Step: 60 / 360 ----> total loss: 0.59396
2021-06-08 18:45:48,508 - INFO - bertNerSpanExample.py - <module> - 212 - {1: 'PRO', 2: 'ORG', 3: 'CONT', 4: 'RACE', 5: 'NAME', 6: 'EDU', 7: 'LOC', 8: 'TITLE'}
2021-06-08 18:45:48,508 - INFO - bertNerSpanExample.py - <module> - 214 - Namespace(adam_epsilon=1e-08, bert_dir='../../model_hub/bert-base-case/', data_dir='../data/cner/', dropout_prob=0.1, eval_batch_size=12, eval_model=True, gpu_ids='0', log_dir='../logs/', lr=2e-05, max_grad_norm=1.0, max_seq_len=150, num_tags=9, other_lr=0.002, output_dir='../checkpoints/', seed=123, swa_start=3, train_batch_size=32, train_epochs=3, warmup_proportion=0.1, weight_decay=0.01)
2021-06-08 18:45:54,677 - INFO - trainUtils.py - load_model_and_parallel - 97 - Use single gpu in: ['0']
2021-06-08 18:45:54,678 - INFO - bertNerSpanExample.py - train - 44 - ***** Running training *****
2021-06-08 18:45:54,678 - INFO - bertNerSpanExample.py - train - 45 -   Num Examples = 3821
2021-06-08 18:45:54,679 - INFO - bertNerSpanExample.py - train - 46 -   Num Epochs = 3
2021-06-08 18:45:54,679 - INFO - bertNerSpanExample.py - train - 47 -   Total training batch size = 32
2021-06-08 18:45:54,679 - INFO - bertNerSpanExample.py - train - 48 -   Total optimization steps = 360
2021-06-08 18:46:02,338 - INFO - bertNerSpanExample.py - train - 72 - Step: 20 / 360 ----> total loss: 2.39701
2021-06-08 18:46:12,076 - INFO - bertNerSpanExample.py - train - 72 - Step: 40 / 360 ----> total loss: 0.87045
2021-06-08 18:46:21,583 - INFO - bertNerSpanExample.py - train - 72 - Step: 60 / 360 ----> total loss: 0.59396
2021-06-08 18:48:55,978 - INFO - bertNerSpanExample.py - <module> - 212 - {1: 'PRO', 2: 'ORG', 3: 'CONT', 4: 'RACE', 5: 'NAME', 6: 'EDU', 7: 'LOC', 8: 'TITLE'}
2021-06-08 18:48:55,978 - INFO - bertNerSpanExample.py - <module> - 214 - Namespace(adam_epsilon=1e-08, bert_dir='../../model_hub/bert-base-case/', data_dir='../data/cner/', dropout_prob=0.1, eval_batch_size=12, eval_model=True, gpu_ids='0', log_dir='../logs/', lr=2e-05, max_grad_norm=1.0, max_seq_len=150, num_tags=9, other_lr=0.002, output_dir='../checkpoints/', seed=123, swa_start=3, train_batch_size=32, train_epochs=3, warmup_proportion=0.1, weight_decay=0.01)
2021-06-08 18:49:02,180 - INFO - trainUtils.py - load_model_and_parallel - 97 - Use single gpu in: ['0']
2021-06-08 18:49:02,181 - INFO - bertNerSpanExample.py - train - 44 - ***** Running training *****
2021-06-08 18:49:02,181 - INFO - bertNerSpanExample.py - train - 45 -   Num Examples = 3821
2021-06-08 18:49:02,181 - INFO - bertNerSpanExample.py - train - 46 -   Num Epochs = 3
2021-06-08 18:49:02,181 - INFO - bertNerSpanExample.py - train - 47 -   Total training batch size = 32
2021-06-08 18:49:02,181 - INFO - bertNerSpanExample.py - train - 48 -   Total optimization steps = 360
2021-06-08 18:49:09,734 - INFO - bertNerSpanExample.py - train - 72 - Step: 20 / 360 ----> total loss: 2.39701
2021-06-08 18:49:19,298 - INFO - bertNerSpanExample.py - train - 72 - Step: 40 / 360 ----> total loss: 0.87045
2021-06-08 18:49:29,042 - INFO - bertNerSpanExample.py - train - 72 - Step: 60 / 360 ----> total loss: 0.59396
2021-06-08 18:50:04,635 - INFO - bertNerSpanExample.py - <module> - 212 - {1: 'PRO', 2: 'ORG', 3: 'CONT', 4: 'RACE', 5: 'NAME', 6: 'EDU', 7: 'LOC', 8: 'TITLE'}
2021-06-08 18:50:04,635 - INFO - bertNerSpanExample.py - <module> - 214 - Namespace(adam_epsilon=1e-08, bert_dir='../../model_hub/bert-base-case/', data_dir='../data/cner/', dropout_prob=0.1, eval_batch_size=12, eval_model=True, gpu_ids='0', log_dir='../logs/', lr=2e-05, max_grad_norm=1.0, max_seq_len=150, num_tags=9, other_lr=0.002, output_dir='../checkpoints/', seed=123, swa_start=3, train_batch_size=32, train_epochs=3, warmup_proportion=0.1, weight_decay=0.01)
2021-06-08 18:50:10,874 - INFO - trainUtils.py - load_model_and_parallel - 97 - Use single gpu in: ['0']
2021-06-08 18:50:10,875 - INFO - bertNerSpanExample.py - train - 44 - ***** Running training *****
2021-06-08 18:50:10,875 - INFO - bertNerSpanExample.py - train - 45 -   Num Examples = 3821
2021-06-08 18:50:10,875 - INFO - bertNerSpanExample.py - train - 46 -   Num Epochs = 3
2021-06-08 18:50:10,875 - INFO - bertNerSpanExample.py - train - 47 -   Total training batch size = 32
2021-06-08 18:50:10,876 - INFO - bertNerSpanExample.py - train - 48 -   Total optimization steps = 360
2021-06-08 18:50:18,534 - INFO - bertNerSpanExample.py - train - 72 - Step: 20 / 360 ----> total loss: 2.39701
2021-06-08 18:50:28,225 - INFO - bertNerSpanExample.py - train - 72 - Step: 40 / 360 ----> total loss: 0.87045
2021-06-08 18:50:38,142 - INFO - bertNerSpanExample.py - train - 72 - Step: 60 / 360 ----> total loss: 0.59396
2021-06-08 18:56:15,101 - INFO - bertNerSpanExample.py - <module> - 212 - {1: 'PRO', 2: 'ORG', 3: 'CONT', 4: 'RACE', 5: 'NAME', 6: 'EDU', 7: 'LOC', 8: 'TITLE'}
2021-06-08 18:56:15,101 - INFO - bertNerSpanExample.py - <module> - 214 - Namespace(adam_epsilon=1e-08, bert_dir='../../model_hub/bert-base-case/', data_dir='../data/cner/', dropout_prob=0.1, eval_batch_size=12, eval_model=True, gpu_ids='0', log_dir='../logs/', lr=2e-05, max_grad_norm=1.0, max_seq_len=150, num_tags=9, other_lr=0.002, output_dir='../checkpoints/', seed=123, swa_start=3, train_batch_size=32, train_epochs=3, warmup_proportion=0.1, weight_decay=0.01)
2021-06-08 18:56:21,279 - INFO - trainUtils.py - load_model_and_parallel - 97 - Use single gpu in: ['0']
2021-06-08 18:56:21,280 - INFO - bertNerSpanExample.py - train - 44 - ***** Running training *****
2021-06-08 18:56:21,281 - INFO - bertNerSpanExample.py - train - 45 -   Num Examples = 3821
2021-06-08 18:56:21,281 - INFO - bertNerSpanExample.py - train - 46 -   Num Epochs = 3
2021-06-08 18:56:21,281 - INFO - bertNerSpanExample.py - train - 47 -   Total training batch size = 32
2021-06-08 18:56:21,281 - INFO - bertNerSpanExample.py - train - 48 -   Total optimization steps = 360
2021-06-08 18:56:28,944 - INFO - bertNerSpanExample.py - train - 72 - Step: 20 / 360 ----> total loss: 2.39701
2021-06-08 18:56:38,801 - INFO - bertNerSpanExample.py - train - 72 - Step: 40 / 360 ----> total loss: 0.87045
2021-06-08 18:56:48,355 - INFO - bertNerSpanExample.py - train - 72 - Step: 60 / 360 ----> total loss: 0.59396
2021-06-08 18:56:58,125 - INFO - bertNerSpanExample.py - train - 72 - Step: 80 / 360 ----> total loss: 0.45289
2021-06-08 18:57:07,943 - INFO - bertNerSpanExample.py - train - 72 - Step: 100 / 360 ----> total loss: 0.41306
2021-06-08 18:57:17,464 - INFO - bertNerSpanExample.py - train - 72 - Step: 120 / 360 ----> total loss: 0.38981
2021-06-08 18:57:27,425 - INFO - bertNerSpanExample.py - train - 72 - Step: 140 / 360 ----> total loss: 0.34511
2021-06-08 18:57:37,653 - INFO - bertNerSpanExample.py - train - 72 - Step: 160 / 360 ----> total loss: 0.29963
2021-06-08 18:57:48,090 - INFO - bertNerSpanExample.py - train - 72 - Step: 180 / 360 ----> total loss: 0.30475
2021-06-08 18:57:58,985 - INFO - bertNerSpanExample.py - train - 72 - Step: 200 / 360 ----> total loss: 0.29061
2021-06-08 18:58:09,971 - INFO - bertNerSpanExample.py - train - 72 - Step: 220 / 360 ----> total loss: 0.29014
2021-06-08 18:58:21,146 - INFO - bertNerSpanExample.py - train - 72 - Step: 240 / 360 ----> total loss: 0.27321
2021-06-08 18:58:32,725 - INFO - bertNerSpanExample.py - train - 72 - Step: 260 / 360 ----> total loss: 0.27517
2021-06-08 18:58:44,768 - INFO - bertNerSpanExample.py - train - 72 - Step: 280 / 360 ----> total loss: 0.25894
2021-06-08 18:58:55,545 - INFO - bertNerSpanExample.py - train - 72 - Step: 300 / 360 ----> total loss: 0.24298
2021-06-08 18:59:04,940 - INFO - bertNerSpanExample.py - train - 72 - Step: 320 / 360 ----> total loss: 0.27048
2021-06-08 18:59:14,241 - INFO - bertNerSpanExample.py - train - 72 - Step: 340 / 360 ----> total loss: 0.23968
2021-06-08 18:59:23,385 - INFO - bertNerSpanExample.py - train - 72 - Step: 360 / 360 ----> total loss: 0.25686
2021-06-08 18:59:25,533 - INFO - trainUtils.py - save_model - 61 - Saving model checkpoint to ../checkpoints/bertSpan-360
2021-06-08 18:59:59,494 - INFO - bertNerSpanExample.py - <module> - 212 - {1: 'PRO', 2: 'ORG', 3: 'CONT', 4: 'RACE', 5: 'NAME', 6: 'EDU', 7: 'LOC', 8: 'TITLE'}
2021-06-08 18:59:59,494 - INFO - bertNerSpanExample.py - <module> - 214 - Namespace(adam_epsilon=1e-08, bert_dir='../../model_hub/bert-base-case/', data_dir='../data/cner/', dropout_prob=0.1, eval_batch_size=12, eval_model=True, gpu_ids='0', log_dir='../logs/', lr=2e-05, max_grad_norm=1.0, max_seq_len=150, num_tags=9, other_lr=0.002, output_dir='../checkpoints/', seed=123, swa_start=3, train_batch_size=32, train_epochs=3, warmup_proportion=0.1, weight_decay=0.01)
2021-06-08 19:00:01,810 - INFO - trainUtils.py - load_model_and_parallel - 87 - Load ckpt from ../checkpoints/bertSpan-360/model.pt
2021-06-08 19:00:05,353 - INFO - trainUtils.py - load_model_and_parallel - 97 - Use single gpu in: ['0']
2021-06-08 19:00:07,080 - INFO - trainUtils.py - load_model_and_parallel - 87 - Load ckpt from ../checkpoints/bertSpan-360/model.pt
2021-06-08 19:00:07,324 - INFO - trainUtils.py - load_model_and_parallel - 97 - Use single gpu in: ['0']
2021-06-19 17:24:03,213 - INFO - bertNerSpanExample.py - <module> - 212 - {1: 'PRO', 2: 'ORG', 3: 'CONT', 4: 'RACE', 5: 'NAME', 6: 'EDU', 7: 'LOC', 8: 'TITLE'}
2021-06-19 17:24:03,213 - INFO - bertNerSpanExample.py - <module> - 214 - Namespace(adam_epsilon=1e-08, bert_dir='../../model_hub/bert-base-case/', data_dir='../data/cner/', dropout_prob=0.1, eval_batch_size=12, eval_model=True, gpu_ids='0', log_dir='../logs/', lr=2e-05, max_grad_norm=1.0, max_seq_len=150, num_tags=9, other_lr=0.002, output_dir='../checkpoints/', seed=123, swa_start=3, train_batch_size=32, train_epochs=3, warmup_proportion=0.1, weight_decay=0.01)
2021-06-19 17:24:05,439 - INFO - trainUtils.py - load_model_and_parallel - 87 - Load ckpt from ../checkpoints/bertSpan-360/model.pt
2021-06-19 17:24:08,137 - INFO - trainUtils.py - load_model_and_parallel - 97 - Use single gpu in: ['0']
2021-06-19 17:24:09,832 - INFO - bertNerSpanExample.py - test - 158 - [eval] precision=0.7608 recall=0.5810 f1_score=0.6588
2021-06-19 17:24:09,833 - INFO - bertNerSpanExample.py - test - 159 -           precision    recall  f1-score   support

     PRO       0.11      0.03      0.05        35
     ORG       0.68      0.49      0.57       571
    CONT       0.96      0.96      0.96        28
    RACE       0.82      1.00      0.90        14
    NAME       0.88      0.88      0.88       112
     EDU       0.84      0.82      0.83       115
     LOC       0.00      0.00      0.00         6
   TITLE       0.78      0.58      0.66       854

micro-f1       0.76      0.58      0.66      1735

2021-06-19 17:24:09,840 - INFO - trainUtils.py - load_model_and_parallel - 87 - Load ckpt from ../checkpoints/bertSpan-360/model.pt
2021-06-19 17:24:10,082 - INFO - trainUtils.py - load_model_and_parallel - 97 - Use single gpu in: ['0']
2021-06-19 17:24:10,123 - INFO - bertNerSpanExample.py - predict - 187 - defaultdict(<class 'list'>, {'NAME': [('顾建国', 0)], 'EDU': [('研究生学历', 6)], 'TITLE': [('正高级工程师', 12), ('董事长', 24), ('马钢(集团)控股有限公司总经理', 28), ('总经理', 40)], 'ORG': [('本公司', 21)]})
